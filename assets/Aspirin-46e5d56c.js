import{V as u,P as N,a as P,S as W,O,C as H,T,b as D,c as q,d as I,M as G}from"./CSS3DRenderer-f5040af3.js";let y,j,w,k,g;const s=[],E=new u,J=new u,X=new u,Y=new u,f=new u;let v=2;const K={Ethanol:"ethanol.pdb",Aspirin:"aspirin.pdb",Caffeine:"caffeine.pdb",Nicotine:"nicotine.pdb",LSD:"lsd.pdb",Cocaine:"cocaine.pdb",Cholesterol:"cholesterol.pdb",Lycopene:"lycopene.pdb",Glucose:"glucose.pdb","Aluminium oxide":"Al2O3.pdb",Cubane:"cubane.pdb",Copper:"cu.pdb",Fluorite:"caf2.pdb",Salt:"nacl.pdb","YBCO superconductor":"ybco.pdb",Buckyball:"buckyball.pdb",Graphite:"graphite.pdb"};let Q=localStorage.getItem("inputValue");const Z=new N,M={},z=document.createElement("img");let $="models/pdb/"+K[Q];document.getElementById("menu");tt();R();function tt(){y=new P(70,window.innerWidth/window.innerHeight,1,5e3),y.position.z=1e3,j=new W,g=new O,j.add(g),w=new H,w.setSize(window.innerWidth,window.innerHeight),document.getElementById("container").appendChild(w.domElement),k=new T(y,w.domElement),k.rotateSpeed=.5,z.onload=function(){it($),et()},z.src="ball.png",window.addEventListener("resize",at)}function et(){const e=document.getElementById("b_a"),t=document.getElementById("b_b"),o=document.getElementById("b_ab");e.addEventListener("click",function(){v=0,V()}),t.addEventListener("click",function(){v=1,F()}),o.addEventListener("click",function(){v=2,U()})}function V(){for(let e=0;e<s.length;e++){const t=s[e];t instanceof D?(t.element.style.display="",t.visible=!0):(t.element.style.display="none",t.visible=!1)}}function F(){for(let e=0;e<s.length;e++){const t=s[e];t instanceof D?(t.element.style.display="none",t.visible=!1):(t.element.style.display="",t.element.style.height=t.userData.bondLengthFull,t.visible=!0)}}function U(){for(let e=0;e<s.length;e++){const t=s[e];t.element.style.display="",t.visible=!0,t instanceof D||(t.element.style.height=t.userData.bondLengthShort)}}function nt(e,t,o,c){const A=c.r,B=c.g,L=c.b,x=e.getImageData(0,0,t,o),p=x.data;for(let l=0,m=p.length;l<m;l+=4)p[l+0]*=A,p[l+1]*=B,p[l+2]*=L;e.putImageData(x,0,0)}function ot(e){const t=e.width,o=e.height,c=document.createElement("canvas");return c.width=t,c.height=o,c.getContext("2d").drawImage(e,0,0,t,o),c}function it(e){for(let t=0;t<s.length;t++){const o=s[t];o.parent.remove(o)}s.length=0,Z.load(e,function(t){const o=t.geometryAtoms,c=t.geometryBonds,A=t.json;o.computeBoundingBox(),o.boundingBox.getCenter(f).negate(),o.translate(f.x,f.y,f.z),c.translate(f.x,f.y,f.z);const B=o.getAttribute("position"),L=o.getAttribute("color"),x=new u,p=new q;for(let r=0;r<B.count;r++){x.fromBufferAttribute(B,r),p.fromBufferAttribute(L,r);const i=A.atoms[r][4];if(!M[i]){const h=ot(z),a=h.getContext("2d");nt(a,h.width,h.height,p);const _=h.toDataURL();M[i]=_}const n=M[i],C=document.createElement("img");C.src=n;const d=new D(C);d.position.copy(x),d.position.multiplyScalar(75),d.matrixAutoUpdate=!1,d.updateMatrix(),g.add(d),s.push(d)}const l=c.getAttribute("position"),m=new u,S=new u;for(let r=0;r<l.count;r+=2){m.fromBufferAttribute(l,r),S.fromBufferAttribute(l,r+1),m.multiplyScalar(75),S.multiplyScalar(75),E.subVectors(S,m);const b=E.length()-50;let i=document.createElement("div");i.className="bond",i.style.height=b+"px";let n=new I(i);n.position.copy(m),n.position.lerp(S,.5),n.userData.bondLengthShort=b+"px",n.userData.bondLengthFull=b+55+"px";const C=J.set(0,1,0).cross(E),d=Math.acos(X.set(0,1,0).dot(Y.copy(E).normalize())),h=new G().makeRotationAxis(C.normalize(),d);n.matrix.copy(h),n.quaternion.setFromRotationMatrix(n.matrix),n.matrixAutoUpdate=!1,n.updateMatrix(),g.add(n),s.push(n),i=document.createElement("div"),i.className="bond",i.style.height=b+"px";const a=new O(i);a.position.copy(m),a.position.lerp(S,.5),a.matrix.copy(h),a.quaternion.setFromRotationMatrix(a.matrix),a.matrixAutoUpdate=!1,a.updateMatrix(),n=new I(i),n.rotation.y=Math.PI/2,n.matrixAutoUpdate=!1,n.updateMatrix(),n.userData.bondLengthShort=b+"px",n.userData.bondLengthFull=b+55+"px",n.userData.joint=a,a.add(n),g.add(a),s.push(n)}switch(v){case 0:V();break;case 1:F();break;case 2:U();break}})}function at(){y.aspect=window.innerWidth/window.innerHeight,y.updateProjectionMatrix(),w.setSize(window.innerWidth,window.innerHeight)}function R(){requestAnimationFrame(R),k.update();const e=Date.now()*4e-4;g.rotation.x=e,g.rotation.y=e*.7,st()}function st(){w.render(j,y)}
